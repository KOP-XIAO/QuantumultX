if ($response.statusCode != 200) {
  $done(null);
}

const emojis= ['ğŸ†˜','ğŸˆ²','âš ï¸','ğŸ”','ğŸ“µ','ğŸš¦','ğŸ–','ğŸ–¥','ğŸ“º','ğŸ§','ğŸ¬','ğŸ¦‰','ğŸ„','â›³ï¸','ğŸš´','ğŸ¤‘','ğŸ‘½','ğŸ¤–','ğŸƒ', 'ğŸ‘º', 'ğŸ‘', 'ğŸ¶', 'ğŸ¼','ğŸŒ', 'ğŸ‘¥']
var city0 = "é«˜è°­å¸‚";
var isp0 = "Cross-GFW.org";
function getRandomInt(max) {
  return Math.floor(Math.random() * Math.floor(max));
}

function City_ValidCheck(para) {
  if(para) {
    if (para.length<6) {
      return para
    } else {
      return para.slice(0,5)
    }
  
  } else
  {
  return city0
//emojis[getRandomInt(emojis.length)]
  }
}

function ISP_ValidCheck(para) {
  if(para) {
  return para
  } else
  {
  return isp0
//emojis[getRandomInt(emojis.length)]
  }
}

function Area_check(para) {
  if(para=="ä¸­åæ°‘å›½"){
  return "å°æ¹¾"
  } else
  {
  return para
  }
}

var flags = new Map([[ "æ¾³å¤§åˆ©äºš" , "ğŸ‡¦ğŸ‡¨" ] , [ "å—é" , "ğŸ‡¦ğŸ‡«" ] , [ "AI" , "ğŸ‡¦ğŸ‡®" ] , [ "AL" , "ğŸ‡¦ğŸ‡±" ] , [ "AM" , "ğŸ‡¦ğŸ‡²" ] , [ "AQ" , "ğŸ‡¦ğŸ‡¶" ] , [ "é˜¿æ ¹å»·" , "ğŸ‡¦ğŸ‡·" ] , [ "AS" , "ğŸ‡¦ğŸ‡¸" ] , [ "å¥¥åœ°åˆ©" , "ğŸ‡¦ğŸ‡¹" ] , [ "AU" , "ğŸ‡¦ğŸ‡º" ] , [ "AW" , "ğŸ‡¦ğŸ‡¼" ] , [ "AX" , "ğŸ‡¦ğŸ‡½" ] , [ "AZ" , "ğŸ‡¦ğŸ‡¿" ] , [ "BB" , "ğŸ‡§ğŸ‡§" ] , [ "BD" , "ğŸ‡§ğŸ‡©" ] , [ "æ¯”åˆ©æ—¶" , "ğŸ‡§ğŸ‡ª" ] , [ "BF" , "ğŸ‡§ğŸ‡«" ] , [ "ä¿åŠ åˆ©äºš" , "ğŸ‡§ğŸ‡¬" ] , [ "BH" , "ğŸ‡§ğŸ‡­" ] , [ "BI" , "ğŸ‡§ğŸ‡®" ] , [ "BJ" , "ğŸ‡§ğŸ‡¯" ] , [ "BM" , "ğŸ‡§ğŸ‡²" ] , [ "BN" , "ğŸ‡§ğŸ‡³" ] , [ "BO" , "ğŸ‡§ğŸ‡´" ] , [ "å·´è¥¿" , "ğŸ‡§ğŸ‡·" ] , [ "BS" , "ğŸ‡§ğŸ‡¸" ] , [ "BT" , "ğŸ‡§ğŸ‡¹" ] , [ "æŒªå¨" , "ğŸ‡§ğŸ‡»" ] , [ "BW" , "ğŸ‡§ğŸ‡¼" ] , [ "BY" , "ğŸ‡§ğŸ‡¾" ] , [ "BZ" , "ğŸ‡§ğŸ‡¿" ] , [ "åŠ æ‹¿å¤§" , "ğŸ‡¨ğŸ‡¦" ] , [ "CF" , "ğŸ‡¨ğŸ‡«" ] , [ "ç‘å£«" , "ğŸ‡¨ğŸ‡­" ] , [ "CK" , "ğŸ‡¨ğŸ‡°" ] , [ "CL" , "ğŸ‡¨ğŸ‡±" ] , [ "CM" , "ğŸ‡¨ğŸ‡²" ] , [ "ä¸­å›½" , "ğŸ‡¨ğŸ‡³" ] , [ "CO" , "ğŸ‡¨ğŸ‡´" ] , [ "CP" , "ğŸ‡¨ğŸ‡µ" ] , [ "CR" , "ğŸ‡¨ğŸ‡·" ] , [ "CU" , "ğŸ‡¨ğŸ‡º" ] , [ "CV" , "ğŸ‡¨ğŸ‡»" ] , [ "CW" , "ğŸ‡¨ğŸ‡¼" ] , [ "CX" , "ğŸ‡¨ğŸ‡½" ] , [ "CY" , "ğŸ‡¨ğŸ‡¾" ] , [ "CZ" , "ğŸ‡¨ğŸ‡¿" ] , [ "å¾·å›½" , "ğŸ‡©ğŸ‡ª" ] , [ "DG" , "ğŸ‡©ğŸ‡¬" ] , [ "DJ" , "ğŸ‡©ğŸ‡¯" ] , [ "ä¸¹éº¦" , "ğŸ‡©ğŸ‡°" ] , [ "DM" , "ğŸ‡©ğŸ‡²" ] , [ "DO" , "ğŸ‡©ğŸ‡´" ] , [ "DZ" , "ğŸ‡©ğŸ‡¿" ] , [ "è¥¿ç­ç‰™" , "ğŸ‡ªğŸ‡¦" ] , [ "EC" , "ğŸ‡ªğŸ‡¨" ] , [ "EE" , "ğŸ‡ªğŸ‡ª" ] , [ "EG" , "ğŸ‡ªğŸ‡¬" ] , [ "EH" , "ğŸ‡ªğŸ‡­" ] , [ "ER" , "ğŸ‡ªğŸ‡·" ] , [ "è¥¿ç­ç‰™" , "ğŸ‡ªğŸ‡¸" ] , [ "ET" , "ğŸ‡ªğŸ‡¹" ] , [ "æ¬§ç›Ÿ" , "ğŸ‡ªğŸ‡º" ] , [ "èŠ¬å…°" , "ğŸ‡«ğŸ‡®" ] , [ "FJ" , "ğŸ‡«ğŸ‡¯" ] , [ "FK" , "ğŸ‡«ğŸ‡°" ] , [ "FM" , "ğŸ‡«ğŸ‡²" ] , [ "FO" , "ğŸ‡«ğŸ‡´" ] , [ "æ³•å›½" , "ğŸ‡«ğŸ‡·" ] , [ "GA" , "ğŸ‡¬ğŸ‡¦" ] , [ "è‹±å›½" , "ğŸ‡¬ğŸ‡§" ] , [ "é¦™æ¸¯" , "ğŸ‡­ğŸ‡°" ] ,["åŒˆç‰™åˆ©","ğŸ‡­ğŸ‡º"], [ "ID" , "ğŸ‡®ğŸ‡©" ] , [ "çˆ±å°”å…°" , "ğŸ‡®ğŸ‡ª" ] , [ "IL" , "ğŸ‡®ğŸ‡±" ] , [ "IM" , "ğŸ‡®ğŸ‡²" ] , [ "å°åº¦" , "ğŸ‡®ğŸ‡³" ] , [ "IS" , "ğŸ‡®ğŸ‡¸" ] , [ "æ„å¤§åˆ©" , "ğŸ‡®ğŸ‡¹" ] , [ "æ—¥æœ¬" , "ğŸ‡¯ğŸ‡µ" ] , [ "éŸ©å›½" , "ğŸ‡°ğŸ‡·" ] , [ "LU" , "ğŸ‡±ğŸ‡º" ] , [ "MO" , "ğŸ‡²ğŸ‡´" ] , [ "å¢¨è¥¿å“¥" , "ğŸ‡²ğŸ‡½" ] , [ "é©¬æ¥è¥¿äºš" , "ğŸ‡²ğŸ‡¾" ] , [ "è·å…°" , "ğŸ‡³ğŸ‡±" ] , [ "è²å¾‹å®¾" , "ğŸ‡µğŸ‡­" ] , [ "RO" , "ğŸ‡·ğŸ‡´" ] , [ "RS" , "ğŸ‡·ğŸ‡¸" ] , [ "ä¿„ç½—æ–¯" , "ğŸ‡·ğŸ‡º" ] , [ "RW" , "ğŸ‡·ğŸ‡¼" ] , [ "SA" , "ğŸ‡¸ğŸ‡¦" ] , [ "SB" , "ğŸ‡¸ğŸ‡§" ] , [ "SC" , "ğŸ‡¸ğŸ‡¨" ] , [ "SD" , "ğŸ‡¸ğŸ‡©" ] , [ "ç‘å…¸" , "ğŸ‡¸ğŸ‡ª" ] , [ "æ–°åŠ å¡" , "ğŸ‡¸ğŸ‡¬" ] , [ "æ³°å›½" , "ğŸ‡¹ğŸ‡­" ] , [ "TN" , "ğŸ‡¹ğŸ‡³" ] , [ "TO" , "ğŸ‡¹ğŸ‡´" ] , [ "åœŸè€³å…¶" , "ğŸ‡¹ğŸ‡·" ] , [ "TV" , "ğŸ‡¹ğŸ‡»" ] , [ "TW" , "ğŸ‡¨ğŸ‡³" ] , [ "è‹±å›½" , "ğŸ‡¬ğŸ‡§" ] , [ "UM" , "ğŸ‡ºğŸ‡²" ] , [ "ç¾å›½" , "ğŸ‡ºğŸ‡¸" ] , [ "UY" , "ğŸ‡ºğŸ‡¾" ] , [ "UZ" , "ğŸ‡ºğŸ‡¿" ] , [ "VA" , "ğŸ‡»ğŸ‡¦" ] , [ "VE" , "ğŸ‡»ğŸ‡ª" ] , [ "VG" , "ğŸ‡»ğŸ‡¬" ] , [ "VI" , "ğŸ‡»ğŸ‡®" ] , [ "è¶Šå—" , "ğŸ‡»ğŸ‡³" ] , [ "å—é" , "ğŸ‡¿ğŸ‡¦"]])
var body = $response.body;
var obj = JSON.parse(body)["data"];
var emoji = flags.get(obj['country'])? flags.get(obj['country']):"ğŸ´â€â˜ ï¸"
emoji=City_ValidCheck(obj['province']) == "é¦™æ¸¯"? "ğŸ‡­ğŸ‡°ï¸":emoji
emoji=City_ValidCheck(obj['province']) == "æ¾³é—¨"? "ï¸ğŸ‡²ğŸ‡´ï¸":emoji
emoji=City_ValidCheck(obj['province']) == "å°æ¹¾"? "ï¸ï¸ğŸ‡¹ğŸ‡¼":emoji
var title =  emoji +'ã€'+ City_ValidCheck(obj['province'])+'ã€';//+Area_check(obj['country']);
var subtitle =  "ğŸ’‹ "+ ISP_ValidCheck(obj['isp']) + " â  "+ obj['country'];
var ip = obj['addr']; 
var description = 'æœåŠ¡å•†:'+obj['isp'] + '\n'+'å®šä½: [' +obj["latitude"]+","+obj["longitude"]+"]"+ '\n' + 'IP:'+ obj['addr'] + '\n' +'æ—¶åŒº:'+ obj['timezone'];
$done({title, subtitle, ip, description});
